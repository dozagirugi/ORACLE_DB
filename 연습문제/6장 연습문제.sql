 --6장 연습문제 레지고

--1번 COMPLETE
SELECT EMPNO,
RPAD((SUBSTR(EMPNO,1,2)), 4, '*') AS MASKING_EMPNO,
-- 또는 SUBSTR(EMPNO,1,2) || '**' AS MASKING_EMPNO,
ENAME, 
RPAD((SUBSTR(ENAME,1,1)), LENGTH(ENAME), '*') AS MASKING_NAME
FROM EMP
WHERE LENGTH (ENAME) = 5;

--2번 COMPLETE
SELECT EMPNO, ENAME, SAL, 
TRUNC (SAL/21.5,2) AS DAY_PAY,
ROUND (SAL/21.5/8,1) AS HOUR_PAY
FROM EMP;

--3번 COMPLETE
SELECT EMPNO, ENAME, HIREDATE, 
TO_CHAR(NEXT_DAY(ADD_MONTHS(HIREDATE, 3), '월요일'), 'YYYY-MM-DD') AS R_JOB,
NVL(TO_CHAR(COMM),'N/A') AS COMM
FROM EMP;


--4번
SELECT EMPNO, ENAME, MGR,
DECODE (MGR,
MGR IS NULL, RPAD(SUBSTR(MGR,1,1),4,0000),
SUBSTR(MGR,1,2)=75, RPAD(MGR,4,7777),
SUBSTR(MGR,1,2)=76, RPAD(MGR,4,7777),
SUBSTR(MGR,1,2)=77, RPAD(MGR,4,7777),
SUBSTR(MGR,1,2)=78, RPAD(MGR,4,8888),
EMPNO) AS CHG_MGR
FROM EMP;

SELECT EMPNO, ENAME, MGR,
DECODE (MGR,
MGR IS NULL, '0000',
SUBSTR(MGR,1,2)='75', '5555',
SUBSTR(MGR,1,2)='76', '6666',
SUBSTR(MGR,1,2)='77', '7777',
SUBSTR(MGR,1,2)='78', '8888',
TO_CHAR(MGR)) AS CHG_MGR
FROM EMP;

SELECT EMPNO, ENAME, MGR,
CASE
WHEN MGR IS NULL THEN '0000'
WHEN SUBSTR(MGR, 1, 2) = '78' THEN '8888'
WHEN SUBSTR(MGR, 1, 2) = '77' THEN '7777'
WHEN SUBSTR(MGR, 1, 2) = '76' THEN '6666'
WHEN SUBSTR(MGR, 1, 2) = '75' THEN '5555'
ELSE TO_CHAR(MGR)
END AS CHG_MGR
FROM EMP;

SELECT EMPNO, ENAME, MGR,
CASE
WHEN MGR IS NULL THEN 0000
WHEN SUBSTR(MGR, 1, 2) = 78 THEN 8888
WHEN SUBSTR(MGR, 1, 2) = 77 THEN 7777
WHEN SUBSTR(MGR, 1, 2) = 76 THEN 6666
WHEN SUBSTR(MGR, 1, 2) = 75 THEN 5555
ELSE MGR
END AS CHG_MGR
FROM EMP;
